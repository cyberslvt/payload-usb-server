<!DOCTYPE html>
<html>
<head>
  <%- include ("../partials/header.ejs") %>
</head>

<body class="text-center">

  <%- include ("../partials/nav.ejs") %>

    <form id="pair-form">
      <h1 class="h3 mb-3 font-weight-normal">Pair new device</h1>
      <label for="inputId" class="sr-only">Pair ID</label>
      <input type="text" id="inputId" class="form-control" placeholder="ID" required="" autofocus="">
      <label for="inputName" class="sr-only">Name</label>
      <input type="text" id="inputName" class="form-control" placeholder="Name" required="">
      <button class="btn btn-lg btn-primary btn-block" type="submit">Pair</button>
    </form>

    <script type="text/javascript" src="/js/utils.js"></script>
    <script>
        function processForm(e) {
            if (e.preventDefault) e.preventDefault();

            var id = $('#inputId').val();
            var name = $('#inputName').val();

            if(!stringValidation(id) || id == "") {return false;}
            if(!stringValidation(name) || name == "") {return false;}

            if(localStorage.getItem("device-list") !== null){
                const devices = JSON.parse(localStorage.getItem("device-list"));
                devices.push({name:name,id:id});
                localStorage.setItem("device-list", JSON.stringify(devices));
            }

            return false;
        }

        $('#pair-form').on('submit', processForm);
    </script>

</body>
</html>
